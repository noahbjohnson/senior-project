
Economic Data Processing (MADDISON)
===================================

   Maddison Project Database, version 2018. Bolt, Jutta, Robert Inklaar,
   Herman de Jong and Jan Luiten van Zanden (2018), “Rebasing
   ‘Maddison’: new income comparisons and the shape of long-run economic
   development”, Maddison Project Working paper 10

Data Dictionary
---------------

+------+---------------------------------------------------------------+
| Full | Data in single table                                          |
| data |                                                               |
+======+===============================================================+
| coun | 3-letter ISO country code                                     |
| tryc |                                                               |
| ode  |                                                               |
+------+---------------------------------------------------------------+
| coun | Country name                                                  |
| try  |                                                               |
+------+---------------------------------------------------------------+
| year | Year                                                          |
+------+---------------------------------------------------------------+
| cgdp | Real GDP per capita in 2011US$, multiple benchmarks (suitable |
| pc   | for cross-country income comparisons)                         |
+------+---------------------------------------------------------------+
| rgdp | Real GDP per capita in 2011US$, 2011 benchmark (suitable for  |
| napc | cross-country growth comparisons)                             |
+------+---------------------------------------------------------------+
| pop  | Population, mid-year (thousands)                              |
+------+---------------------------------------------------------------+
| i_ci | 0/1/2: observation is extrapolated (0), benchmark (1), or     |
| g    | interpolated (2)                                              |
+------+---------------------------------------------------------------+
| i_bm | For benchmark observations: 1: ICP PPP estimates, 2:          |
|      | Historical income benchmarks, 3: Real wages and urbanization, |
|      | 4: Multiple of subsistence, 5: Braithwaite (1968) PPPs        |
+------+---------------------------------------------------------------+
| Part | Data for selected sub-national units with long time series    |
| ial  |                                                               |
| coun |                                                               |
| trie |                                                               |
| s    |                                                               |
+------+---------------------------------------------------------------+

.. code:: ipython3

    import pandas as pd
    import pycountry
    
    %matplotlib inline
    
    pd.set_option('display.float_format', lambda x: '%.3f' % x)

Load The File
-------------

.. code:: ipython3

    df = pd.read_excel("../data/external/Economy/MADDISON/mpd2018.xlsx",
                       sheet_name='Full data')

.. code:: ipython3

    df.sample(5)




.. raw:: html

    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }
    
        .dataframe tbody tr th {
            vertical-align: top;
        }
    
        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>countrycode</th>
          <th>country</th>
          <th>year</th>
          <th>cgdppc</th>
          <th>rgdpnapc</th>
          <th>pop</th>
          <th>i_cig</th>
          <th>i_bm</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>13232</th>
          <td>PAK</td>
          <td>Pakistan</td>
          <td>1992</td>
          <td>2464.000</td>
          <td>3290.000</td>
          <td>120535.000</td>
          <td>Interpolated</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>14797</th>
          <td>PRT</td>
          <td>Portugal</td>
          <td>1633</td>
          <td>1237.000</td>
          <td>1611.000</td>
          <td>nan</td>
          <td>Extrapolated</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>9853</th>
          <td>KOR</td>
          <td>Republic of Korea</td>
          <td>2000</td>
          <td>22930.000</td>
          <td>21420.000</td>
          <td>47008.000</td>
          <td>Interpolated</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>17821</th>
          <td>THA</td>
          <td>Thailand</td>
          <td>2015</td>
          <td>13938.000</td>
          <td>15020.000</td>
          <td>66886.000</td>
          <td>Extrapolated</td>
          <td>NaN</td>
        </tr>
        <tr>
          <th>17929</th>
          <td>TKM</td>
          <td>Turkmenistan</td>
          <td>1989</td>
          <td>6061.000</td>
          <td>7524.000</td>
          <td>3572.000</td>
          <td>Extrapolated</td>
          <td>NaN</td>
        </tr>
      </tbody>
    </table>
    </div>



Standardize Country Codes
-------------------------

.. code:: ipython3

    """ Only Select rows with valid country codes
    """
    country_locations = []
    for country in df['countrycode']:
        try:
            pycountry.countries.lookup(country)
            country_locations.append(True)
        except LookupError:
            country_locations.append(False)
    df = df[country_locations]

Standardize Indexes
-------------------

Years (1995≤ x ≥2017)
~~~~~~~~~~~~~~~~~~~~~

.. code:: ipython3

    df = df[df['year'] >= 1995]
    df = df[df['year'] <= 2017]

Reindex & Rename
~~~~~~~~~~~~~~~~

.. code:: ipython3

    df.rename(
        {
            "year": "Year",
            "countrycode": "Country Code",
            "cgdppc": "Maddison GDPPC"
        },
        axis='columns',
        inplace=True)

.. code:: ipython3

    df.set_index(["Country Code", "Year"], inplace=True)

Clean Data
----------

Remove unneeded variables
~~~~~~~~~~~~~~~~~~~~~~~~~

.. code:: ipython3

    df.drop(["country", "i_cig", "i_bm", "rgdpnapc", "pop"],
            axis='columns',
            inplace=True)

Data Types
~~~~~~~~~~

.. code:: ipython3

    df.dtypes




.. parsed-literal::

    Maddison GDPPC    float64
    dtype: object



Save Data
---------

.. code:: ipython3

    df.to_pickle("../data/processed/Economic_MADDISON.pickle")
