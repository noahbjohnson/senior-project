
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>1. Tourism Data Processing &#8212; Senior-Project 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Tourism Master Dataset Merge" href="1.html" />
    <link rel="prev" title="Data Preperation Notebooks" href="../../prep_notebooks.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="1.html" title="2. Tourism Master Dataset Merge"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../prep_notebooks.html" title="Data Preperation Notebooks"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Senior-Project 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../prep_notebooks.html" accesskey="U">Data Preperation Notebooks</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tourism-data-processing">
<h1>1. Tourism Data Processing<a class="headerlink" href="#tourism-data-processing" title="Permalink to this headline">¶</a></h1>
<p>DS Senior Project - Noah B Johnson - Luther College</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pycountry</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="world-development-indicators">
<h2>1.1. World Development Indicators<a class="headerlink" href="#world-development-indicators" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
    <span class="s2">&quot;../data/external/Tourism/WDI/Data_Extract_From_World_Development_Indicators.xlsx&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Series Name</th>
      <th>Series Code</th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>1960 [YR1960]</th>
      <th>1961 [YR1961]</th>
      <th>1962 [YR1962]</th>
      <th>1963 [YR1963]</th>
      <th>1964 [YR1964]</th>
      <th>1965 [YR1965]</th>
      <th>...</th>
      <th>2009 [YR2009]</th>
      <th>2010 [YR2010]</th>
      <th>2011 [YR2011]</th>
      <th>2012 [YR2012]</th>
      <th>2013 [YR2013]</th>
      <th>2014 [YR2014]</th>
      <th>2015 [YR2015]</th>
      <th>2016 [YR2016]</th>
      <th>2017 [YR2017]</th>
      <th>2018 [YR2018]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>International tourism, number of arrivals</td>
      <td>ST.INT.ARVL</td>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
    </tr>
    <tr>
      <th>1</th>
      <td>International tourism, number of arrivals</td>
      <td>ST.INT.ARVL</td>
      <td>Albania</td>
      <td>ALB</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>1711000</td>
      <td>2191000</td>
      <td>2469000</td>
      <td>3156000</td>
      <td>2857000</td>
      <td>3341000</td>
      <td>3784000</td>
      <td>4070000</td>
      <td>4643000</td>
      <td>..</td>
    </tr>
    <tr>
      <th>2</th>
      <td>International tourism, number of arrivals</td>
      <td>ST.INT.ARVL</td>
      <td>Algeria</td>
      <td>DZA</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>1912000</td>
      <td>2070000</td>
      <td>2395000</td>
      <td>2634000</td>
      <td>2733000</td>
      <td>2301000</td>
      <td>1710000</td>
      <td>2039000</td>
      <td>2451000</td>
      <td>..</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 63 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi</span><span class="p">[</span><span class="s1">&#39;Series Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;ST.INT.ARVL&#39;</span><span class="p">,</span> <span class="s1">&#39;ST.INT.XPND.MP.ZS&#39;</span><span class="p">,</span> <span class="s1">&#39;ST.INT.XPND.CD&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ST.INT.TRNX.CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ST.INT.TVLX.CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ST.INT.DPRT&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ST.INT.RCPT.XP.ZS&#39;</span><span class="p">,</span> <span class="s1">&#39;ST.INT.RCPT.CD&#39;</span><span class="p">,</span> <span class="s1">&#39;ST.INT.TRNR.CD&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ST.INT.TVLR.CD&#39;</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Series Name</th>
      <th>Series Code</th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>1960 [YR1960]</th>
      <th>1961 [YR1961]</th>
      <th>1962 [YR1962]</th>
      <th>1963 [YR1963]</th>
      <th>1964 [YR1964]</th>
      <th>1965 [YR1965]</th>
      <th>...</th>
      <th>2009 [YR2009]</th>
      <th>2010 [YR2010]</th>
      <th>2011 [YR2011]</th>
      <th>2012 [YR2012]</th>
      <th>2013 [YR2013]</th>
      <th>2014 [YR2014]</th>
      <th>2015 [YR2015]</th>
      <th>2016 [YR2016]</th>
      <th>2017 [YR2017]</th>
      <th>2018 [YR2018]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2642</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2643</th>
      <td>Data from database: World Development Indicators</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2644</th>
      <td>Last Updated: 01/30/2019</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 63 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># nan is not a valid series code, so we should remove those rows</span>
<span class="n">wdi</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Series Code&#39;</span><span class="p">,</span> <span class="s1">&#39;Country Code&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Series Name</th>
      <th>Series Code</th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>1960 [YR1960]</th>
      <th>1961 [YR1961]</th>
      <th>1962 [YR1962]</th>
      <th>1963 [YR1963]</th>
      <th>1964 [YR1964]</th>
      <th>1965 [YR1965]</th>
      <th>...</th>
      <th>2009 [YR2009]</th>
      <th>2010 [YR2010]</th>
      <th>2011 [YR2011]</th>
      <th>2012 [YR2012]</th>
      <th>2013 [YR2013]</th>
      <th>2014 [YR2014]</th>
      <th>2015 [YR2015]</th>
      <th>2016 [YR2016]</th>
      <th>2017 [YR2017]</th>
      <th>2018 [YR2018]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2637</th>
      <td>International tourism, receipts for travel ite...</td>
      <td>ST.INT.TVLR.CD</td>
      <td>Sub-Saharan Africa (IDA &amp; IBRD countries)</td>
      <td>TSS</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>19838943841.034</td>
      <td>21673657225.577</td>
      <td>23876418124.733</td>
      <td>26142967778.798</td>
      <td>25790138383.752</td>
      <td>27057578741.885</td>
      <td>24763693256.545</td>
      <td>25325608754.148</td>
      <td>29007199323.610</td>
      <td>..</td>
    </tr>
    <tr>
      <th>2638</th>
      <td>International tourism, receipts for travel ite...</td>
      <td>ST.INT.TVLR.CD</td>
      <td>Upper middle income</td>
      <td>UMC</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>177103169507.960</td>
      <td>193953837035.759</td>
      <td>213249737962.092</td>
      <td>227425606689.724</td>
      <td>246611754348.080</td>
      <td>246280828980.337</td>
      <td>244234779637.110</td>
      <td>241924733652.200</td>
      <td>253188732331.635</td>
      <td>..</td>
    </tr>
    <tr>
      <th>2639</th>
      <td>International tourism, receipts for travel ite...</td>
      <td>ST.INT.TVLR.CD</td>
      <td>World</td>
      <td>WLD</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>893141573444.509</td>
      <td>965630203496.872</td>
      <td>1077839164714.778</td>
      <td>1114345084520.954</td>
      <td>1199717631267.226</td>
      <td>1261290553785.728</td>
      <td>1215027166077.664</td>
      <td>1238015449937.971</td>
      <td>1338751045869.408</td>
      <td>..</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 63 columns</p>
</div><div class="section" id="pivoting-the-data">
<h3>1.1.1. Pivoting the Data<a class="headerlink" href="#pivoting-the-data" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Target format is data by year-country with indicator columns</p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Making our keys</span>
<span class="n">country_codes</span> <span class="o">=</span> <span class="n">wdi</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">wdi</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;We will have </span><span class="si">{}</span><span class="s2"> rows&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">country_codes</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">We</span> <span class="n">will</span> <span class="n">have</span> <span class="mi">15576</span> <span class="n">rows</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Manual transposition of data</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">year_column</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">country_column</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_columns</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ST.INT.ARVL&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.XPND.MP.ZS&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.XPND.CD&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.TRNX.CD&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.TVLX.CD&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.DPRT&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.RCPT.XP.ZS&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.RCPT.CD&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.TRNR.CD&#39;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s1">&#39;ST.INT.TVLR.CD&#39;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">country_codes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
        <span class="n">year_column</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
        <span class="n">country_column</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">indicator</span> <span class="ow">in</span> <span class="n">data_columns</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">cdf</span> <span class="o">=</span> <span class="n">wdi</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">wdi</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">country</span><span class="p">)]</span>
            <span class="n">datum</span> <span class="o">=</span> <span class="n">cdf</span><span class="p">[</span><span class="n">cdf</span><span class="p">[</span><span class="s1">&#39;Series Code&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">indicator</span><span class="p">][</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">data_columns</span><span class="p">[</span><span class="n">indicator</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Reassign country and year to columns</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">data_columns</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year_column</span>
<span class="n">data_columns</span><span class="p">[</span><span class="s2">&quot;Country Code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_column</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Data is correctly formatted</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="cleaning-data">
<h3>1.1.2. Cleaning data<a class="headerlink" href="#cleaning-data" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>fix nans, assign correct data types, and standardize countries</p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi_clean</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST.INT.ARVL</th>
      <th>ST.INT.XPND.MP.ZS</th>
      <th>ST.INT.XPND.CD</th>
      <th>ST.INT.TRNX.CD</th>
      <th>ST.INT.TVLX.CD</th>
      <th>ST.INT.DPRT</th>
      <th>ST.INT.RCPT.XP.ZS</th>
      <th>ST.INT.RCPT.CD</th>
      <th>ST.INT.TRNR.CD</th>
      <th>ST.INT.TVLR.CD</th>
      <th>Year</th>
      <th>Country Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>1960 [YR1960]</td>
      <td>AFG</td>
    </tr>
    <tr>
      <th>1</th>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>1961 [YR1961]</td>
      <td>AFG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>1962 [YR1962]</td>
      <td>AFG</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Replace &#39;..&#39; with np.nan for better parsing</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span> <span class="o">=</span> <span class="n">wdi_clean</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi_clean</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST.INT.ARVL</th>
      <th>ST.INT.XPND.MP.ZS</th>
      <th>ST.INT.XPND.CD</th>
      <th>ST.INT.TRNX.CD</th>
      <th>ST.INT.TVLX.CD</th>
      <th>ST.INT.DPRT</th>
      <th>ST.INT.RCPT.XP.ZS</th>
      <th>ST.INT.RCPT.CD</th>
      <th>ST.INT.TRNR.CD</th>
      <th>ST.INT.TVLR.CD</th>
      <th>Year</th>
      <th>Country Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>1960 [YR1960]</td>
      <td>AFG</td>
    </tr>
    <tr>
      <th>1</th>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>1961 [YR1961]</td>
      <td>AFG</td>
    </tr>
    <tr>
      <th>2</th>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>1962 [YR1962]</td>
      <td>AFG</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Assign all columns except year and country to float dtype</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span><span class="p">[</span><span class="n">wdi_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">wdi_clean</span><span class="p">[</span><span class="n">wdi_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Check the dtypes of the dataframe</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span><span class="o">.</span><span class="n">get_dtype_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">float64</span>    <span class="mi">10</span>
<span class="nb">object</span>      <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Remove the bracketed text and parse year into an integer so: &#39;1960 [YR1960]&#39; → int(1960)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wdi_clean</span><span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^\d*&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                                            <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Check year values</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST.INT.ARVL</th>
      <th>ST.INT.XPND.MP.ZS</th>
      <th>ST.INT.XPND.CD</th>
      <th>ST.INT.TRNX.CD</th>
      <th>ST.INT.TVLX.CD</th>
      <th>ST.INT.DPRT</th>
      <th>ST.INT.RCPT.XP.ZS</th>
      <th>ST.INT.RCPT.CD</th>
      <th>ST.INT.TRNR.CD</th>
      <th>ST.INT.TVLR.CD</th>
      <th>Year</th>
      <th>Country Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10901</th>
      <td>96000.000</td>
      <td>5.151</td>
      <td>15000000.000</td>
      <td>nan</td>
      <td>15000000.000</td>
      <td>nan</td>
      <td>51.859</td>
      <td>104000000.000</td>
      <td>nan</td>
      <td>104000000.000</td>
      <td>2005</td>
      <td>VCT</td>
    </tr>
    <tr>
      <th>2870</th>
      <td>4499000.000</td>
      <td>5.693</td>
      <td>600000000.000</td>
      <td>nan</td>
      <td>600000000.000</td>
      <td>nan</td>
      <td>31.989</td>
      <td>2733400000.000</td>
      <td>nan</td>
      <td>2733400000.000</td>
      <td>1998</td>
      <td>HRV</td>
    </tr>
    <tr>
      <th>8592</th>
      <td>611000.000</td>
      <td>42.441</td>
      <td>1840000000.000</td>
      <td>24000000.000</td>
      <td>1816000000.000</td>
      <td>nan</td>
      <td>1.701</td>
      <td>83000000.000</td>
      <td>28000000.000</td>
      <td>55000000.000</td>
      <td>1997</td>
      <td>NGA</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Create a mask without regions and custom groupings,</span>
<span class="sd">selecting only valid country entries</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">country_bool</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">wdi_clean</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
        <span class="n">country_bool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
        <span class="n">country_bool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">wdi_clean</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">264</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi_clean</span> <span class="o">=</span> <span class="n">wdi_clean</span><span class="p">[</span><span class="n">country_bool</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">wdi_clean</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">215</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Standardize the country codes</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">country_codes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">wdi_clean</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
    <span class="n">country_codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">country</span><span class="p">)</span><span class="o">.</span><span class="n">alpha_3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Country Code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_codes</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdi_clean</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ST.INT.ARVL</th>
      <th>ST.INT.XPND.MP.ZS</th>
      <th>ST.INT.XPND.CD</th>
      <th>ST.INT.TRNX.CD</th>
      <th>ST.INT.TVLX.CD</th>
      <th>ST.INT.DPRT</th>
      <th>ST.INT.RCPT.XP.ZS</th>
      <th>ST.INT.RCPT.CD</th>
      <th>ST.INT.TRNR.CD</th>
      <th>ST.INT.TVLR.CD</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4390.000</td>
      <td>3748.000</td>
      <td>4055.000</td>
      <td>3289.000</td>
      <td>3956.000</td>
      <td>2234.000</td>
      <td>3752.000</td>
      <td>4266.000</td>
      <td>3033.000</td>
      <td>3985.000</td>
      <td>12685.000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4417208.200</td>
      <td>6.605</td>
      <td>4828076388.212</td>
      <td>794672287.039</td>
      <td>4228815999.141</td>
      <td>8031308.268</td>
      <td>16.952</td>
      <td>4928297940.752</td>
      <td>922708154.258</td>
      <td>4476780046.173</td>
      <td>1989.000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>10272868.297</td>
      <td>4.332</td>
      <td>15399011971.733</td>
      <td>2718791242.890</td>
      <td>13733953517.299</td>
      <td>16159876.350</td>
      <td>18.848</td>
      <td>14801029019.088</td>
      <td>2995992210.148</td>
      <td>12946159292.781</td>
      <td>17.030</td>
    </tr>
    <tr>
      <th>min</th>
      <td>700.000</td>
      <td>0.183</td>
      <td>100000.000</td>
      <td>100000.000</td>
      <td>10000.000</td>
      <td>1900.000</td>
      <td>0.001</td>
      <td>100000.000</td>
      <td>11000.000</td>
      <td>100000.000</td>
      <td>1960.000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>199000.000</td>
      <td>3.696</td>
      <td>97000000.000</td>
      <td>21000000.000</td>
      <td>71000000.000</td>
      <td>486250.000</td>
      <td>4.269</td>
      <td>119250000.000</td>
      <td>17000000.000</td>
      <td>107000000.000</td>
      <td>1974.000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>800000.000</td>
      <td>5.579</td>
      <td>423000000.000</td>
      <td>87000000.000</td>
      <td>329367300.000</td>
      <td>1957000.000</td>
      <td>9.356</td>
      <td>660000000.000</td>
      <td>128000000.000</td>
      <td>578000000.000</td>
      <td>1989.000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3513500.000</td>
      <td>8.303</td>
      <td>2628500000.000</td>
      <td>375000000.000</td>
      <td>2240000000.000</td>
      <td>7331250.000</td>
      <td>22.104</td>
      <td>3372000000.000</td>
      <td>593000000.000</td>
      <td>3204000000.000</td>
      <td>2004.000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>86861000.000</td>
      <td>42.441</td>
      <td>257733000000.000</td>
      <td>38896000000.000</td>
      <td>257733000000.000</td>
      <td>143035000.000</td>
      <td>170.479</td>
      <td>251361000000.000</td>
      <td>44071000000.000</td>
      <td>210748000000.000</td>
      <td>2018.000</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="saving-data">
<h3>1.1.3. Saving Data<a class="headerlink" href="#saving-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Save the cleaned and standardized data</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">wdi_clean</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;../data/interim/WDI.pickle&quot;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Series Code&#39;</span><span class="p">:</span> <span class="n">wdi</span><span class="p">[</span><span class="s1">&#39;Series Code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span>
    <span class="s1">&#39;Series Name&#39;</span><span class="p">:</span> <span class="n">wdi</span><span class="p">[</span><span class="s1">&#39;Series Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="p">})</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;../data/interim/WDI_DD.pickle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="world-tourism-organization">
<h2>1.2. World Tourism Organization<a class="headerlink" href="#world-tourism-organization" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span>
    <span class="s2">&quot;../data/external/Tourism/UWTO/Arrivals of non resident tourists_visitors, depart.xls&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="section" id="grouping-by-country">
<h3>1.2.1. Grouping by Country<a class="headerlink" href="#grouping-by-country" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Create a mask without regions and custom groupings,</span>
<span class="sd">selecting only valid country entries</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">country_locations</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">uwto</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
        <span class="n">country_locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">country_locations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uwto</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Create a dataframe for each country code</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">country_slices</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">country_locations</span><span class="p">)):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">country_slices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">[</span><span class="n">country_locations</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">country_locations</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">pass</span>
<span class="n">nation_frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">country_slices</span><span class="p">:</span>
    <span class="n">nation_frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">uwto</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Clean the dataframes and flatten into standard format</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">clean_nations</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">nation</span> <span class="ow">in</span> <span class="n">nation_frames</span><span class="p">:</span>
    <span class="n">nation</span> <span class="o">=</span> <span class="n">nation</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">nation_name</span> <span class="o">=</span> <span class="n">nation</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># list of row indexes indicating a chunk of data (inbound/outbound)</span>
    <span class="n">chunk_headers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">nation</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="s1">&#39;bound tourism&#39;</span> <span class="ow">in</span> <span class="n">country</span><span class="p">:</span>
            <span class="n">chunk_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># New dfs on variable groups</span>
    <span class="n">inbound</span> <span class="o">=</span> <span class="n">nation</span><span class="p">[</span><span class="n">chunk_headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">chunk_headers</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">outbound</span> <span class="o">=</span> <span class="n">nation</span><span class="p">[</span><span class="n">chunk_headers</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span>

    <span class="c1"># rename variables to flatten index</span>
    <span class="n">outbound</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Outbound: &#39;</span> <span class="o">+</span> <span class="n">outbound</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span>
    <span class="n">inbound</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Inbound: &#39;</span> <span class="o">+</span> <span class="n">inbound</span><span class="p">[</span><span class="mi">1</span><span class="p">:][</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span>

    <span class="c1"># combine variable groups and remove index rows</span>
    <span class="n">rejoined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">outbound</span><span class="p">,</span> <span class="n">inbound</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># move indicators to correct column</span>
    <span class="n">rejoined</span><span class="p">[</span><span class="s1">&#39;Indicator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rejoined</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span>

    <span class="c1"># set the country name to the correct value</span>
    <span class="n">rejoined</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nation_name</span>

    <span class="c1"># Fix column order</span>
    <span class="n">rejoined</span> <span class="o">=</span> <span class="n">rejoined</span><span class="p">[[</span>
        <span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Indicator&#39;</span><span class="p">,</span> <span class="mi">1995</span><span class="p">,</span> <span class="mi">1996</span><span class="p">,</span> <span class="mi">1997</span><span class="p">,</span> <span class="mi">1998</span><span class="p">,</span> <span class="mi">1999</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">2001</span><span class="p">,</span> <span class="mi">2002</span><span class="p">,</span>
        <span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span>
        <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span>
    <span class="p">]]</span>

    <span class="c1"># add to clean list</span>
    <span class="n">clean_nations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rejoined</span><span class="p">)</span>

<span class="n">uwto_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">clean_nations</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">travis</span><span class="o">/</span><span class="n">virtualenv</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">543</span><span class="p">:</span> <span class="n">SettingWithCopyWarning</span><span class="p">:</span>
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">DataFrame</span><span class="o">.</span>
<span class="n">Try</span> <span class="n">using</span> <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span><span class="n">col_indexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="n">instead</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#indexing-view-versus-copy</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
</pre></div>
</div>
</div>
<div class="section" id="clean-values-and-group-variables-on-means">
<h3>1.2.2. Clean Values and Group Variables on Means<a class="headerlink" href="#clean-values-and-group-variables-on-means" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_clean</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTRY</th>
      <th>Indicator</th>
      <th>1995</th>
      <th>1996</th>
      <th>1997</th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>AFGHANISTAN</td>
      <td>Outbound: Departures - Thousands</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AFGHANISTAN</td>
      <td>Outbound: Tourism expenditure in other countri...</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>28</td>
      <td>70</td>
      <td>106</td>
      <td>255</td>
      <td>110</td>
      <td>138</td>
      <td>140</td>
      <td>151</td>
      <td>89</td>
      <td>132</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AFGHANISTAN</td>
      <td>Outbound: Travel - US$ Mn</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>...</td>
      <td>26</td>
      <td>68</td>
      <td>103</td>
      <td>246</td>
      <td>105</td>
      <td>132</td>
      <td>137</td>
      <td>147</td>
      <td>79</td>
      <td>118</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 25 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Replace &#39;..&#39; with np.nan for better parsing</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">uwto_clean</span> <span class="o">=</span> <span class="n">uwto_clean</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_clean</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTRY</th>
      <th>Indicator</th>
      <th>1995</th>
      <th>1996</th>
      <th>1997</th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>...</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
      <th>2014</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>AFGHANISTAN</td>
      <td>Outbound: Departures - Thousands</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>...</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>8</th>
      <td>AFGHANISTAN</td>
      <td>Outbound: Tourism expenditure in other countri...</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>...</td>
      <td>28.000</td>
      <td>70.000</td>
      <td>106.000</td>
      <td>255.000</td>
      <td>110.000</td>
      <td>138.000</td>
      <td>140.000</td>
      <td>151.000</td>
      <td>89.000</td>
      <td>132.000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AFGHANISTAN</td>
      <td>Outbound: Travel - US$ Mn</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>...</td>
      <td>26.000</td>
      <td>68.000</td>
      <td>103.000</td>
      <td>246.000</td>
      <td>105.000</td>
      <td>132.000</td>
      <td>137.000</td>
      <td>147.000</td>
      <td>79.000</td>
      <td>118.000</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 25 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Assign all columns except indicator and country to float dtype</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">uwto_clean</span><span class="p">[</span><span class="n">uwto_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span> <span class="o">=</span> <span class="n">uwto_clean</span><span class="p">[</span><span class="n">uwto_clean</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_clean</span><span class="o">.</span><span class="n">get_dtype_counts</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">float64</span>    <span class="mi">23</span>
<span class="nb">object</span>      <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Select unique</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">uwto_clean</span> <span class="o">=</span> <span class="n">uwto_clean</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">,</span> <span class="s1">&#39;Indicator&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="pivot-the-data">
<h3>1.2.3. Pivot the Data<a class="headerlink" href="#pivot-the-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Move indicators to the columns index</span>
<span class="n">unstacked</span> <span class="o">=</span> <span class="n">uwto_clean</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="c1"># Name column indexes</span>
<span class="n">unstacked</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Indicator&#39;</span><span class="p">]</span>
<span class="c1"># move year to row index</span>
<span class="n">restacked</span> <span class="o">=</span> <span class="n">unstacked</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># move country and year to columns</span>
<span class="n">uwto_pivoted</span> <span class="o">=</span> <span class="n">restacked</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="c1"># remove indicator label from column index</span>
<span class="n">uwto_pivoted</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_pivoted</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNTRY</th>
      <th>Year</th>
      <th>Inbound: Arrivals - Thousands</th>
      <th>Inbound: Passenger transport - US$ Mn</th>
      <th>Inbound: Tourism expenditure in the country - US$ Mn</th>
      <th>Inbound: Travel - US$ Mn</th>
      <th>Outbound: Arrivals - Thousands</th>
      <th>Outbound: Departures - Thousands</th>
      <th>Outbound: Passenger transport - US$ Mn</th>
      <th>Outbound: Tourism expenditure in other countries - US$ Mn</th>
      <th>Outbound: Tourism expenditure in the country - US$ Mn</th>
      <th>Outbound: Travel - US$ Mn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFGHANISTAN</td>
      <td>1995</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AFGHANISTAN</td>
      <td>1996</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AFGHANISTAN</td>
      <td>1997</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
      <td>nan</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="standardize-country-codes">
<h3>1.2.4. Standardize Country Codes<a class="headerlink" href="#standardize-country-codes" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_pivoted</span><span class="p">[</span><span class="s1">&#39;Country Code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">uwto_pivoted</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pycountry</span><span class="o">.</span><span class="n">countries</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">alpha_3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_pivoted</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;COUNTRY&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="save-the-data">
<h3>1.2.5. Save the Data<a class="headerlink" href="#save-the-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwto_pivoted</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="s2">&quot;../data/interim/UWTO.pickle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Tourism Data Processing</a><ul>
<li><a class="reference internal" href="#world-development-indicators">1.1. World Development Indicators</a><ul>
<li><a class="reference internal" href="#pivoting-the-data">1.1.1. Pivoting the Data</a></li>
<li><a class="reference internal" href="#cleaning-data">1.1.2. Cleaning data</a></li>
<li><a class="reference internal" href="#saving-data">1.1.3. Saving Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#world-tourism-organization">1.2. World Tourism Organization</a><ul>
<li><a class="reference internal" href="#grouping-by-country">1.2.1. Grouping by Country</a></li>
<li><a class="reference internal" href="#clean-values-and-group-variables-on-means">1.2.2. Clean Values and Group Variables on Means</a></li>
<li><a class="reference internal" href="#pivot-the-data">1.2.3. Pivot the Data</a></li>
<li><a class="reference internal" href="#standardize-country-codes">1.2.4. Standardize Country Codes</a></li>
<li><a class="reference internal" href="#save-the-data">1.2.5. Save the Data</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../../prep_notebooks.html"
                        title="previous chapter">Data Preperation Notebooks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="1.html"
                        title="next chapter">2. Tourism Master Dataset Merge</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/notebooks/prep/0.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="1.html" title="2. Tourism Master Dataset Merge"
             >next</a> |</li>
        <li class="right" >
          <a href="../../prep_notebooks.html" title="Data Preperation Notebooks"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Senior-Project 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../prep_notebooks.html" >Data Preperation Notebooks</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
  </body>
</html>