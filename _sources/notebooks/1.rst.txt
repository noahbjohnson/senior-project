
Tourism Master Dataset Merge
============================

Data Sources Overview
---------------------

World Tourism Organization (UWTO)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    The United Nations agency responsible for the promotion of
    responsible, sustainable and universally accessible tourism.

Variables
^^^^^^^^^

-  Inbound tourism
-  Arrivals - Thousands
-  Tourism expenditure in the country - US$ Mn
-  Travel - US$ Mn
-  Passenger transport - US$ Mn
-  Outbound tourism
-  Departures - Thousands
-  Tourism expenditure in other countries - US$ Mn
-  Travel - US$ Mn
-  Passenger transport - US$ Mn

World Development Indicators (table 6.14)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    The World Development Indicators is a compilation of relevant,
    high-quality, and internationally comparable statistics about global
    development and the fight against poverty. The data concerning
    tourism in the WDI is primarily from the UWTO, with supplementary
    data from IMF and World Bank.

Variables
^^^^^^^^^

-  Inbound tourism
-  ST.INT.ARVL

   -  International tourism, number of arrivals
   -  International inbound tourists (overnight visitors) are the number
      of tourists who travel to a country other than that in which they
      have their usual residence, but outside their usual environment,
      for a period not exceeding 12 months and whose main purpose in
      visiting is other than an activity remunerated from within the
      country visited. When data on number of tourists are not
      available, the number of visitors, which includes tourists,
      same-day visitors, cruise passengers, and crew members, is shown
      instead. Sources and collection methods for arrivals differ across
      countries. In some cases data are from border statistics (police,
      immigration, and the like) and supplemented by border surveys.

-  ST.INT.RCPT.XP.ZS

   -  International tourism, receipts (% of total exports)
   -  International tourism receipts are expenditures by international
      inbound visitors, including payments to national carriers for
      international transport. These receipts include any other
      prepayment made for goods or services received in the destination
      country. They also may include receipts from same-day visitors,
      except when these are important enough to justify separate
      classification. For some countries they do not include receipts
      for passenger transport items. Their share in exports is
      calculated as a ratio to exports of goods and services, which
      comprise all transactions between residents of a country and the
      rest of the world involving a change of ownership from residents
      to nonresidents of general merchandise, goods sent for processing
      and repairs, nonmonetary gold, and services.

-  ST.INT.RCPT.CD

   -  International tourism, receipts (current US$)
   -  International tourism receipts are expenditures by international
      inbound visitors, including payments to national carriers for
      international transport. These receipts include any other
      prepayment made for goods or services received in the destination
      country. They also may include receipts from same-day visitors,
      except when these are important enough to justify separate
      classification. For some countries they do not include receipts
      for passenger transport items. Data are in current U.S. dollars.

-  ST.INT.TRNR.CD

   -  International tourism, receipts for passenger transport items
      (current US$)
   -  International tourism receipts for passenger transport items are
      expenditures by international inbound visitors for all services
      provided in the international transportation by resident carriers.
      Also included are passenger services performed within an economy
      by nonresident carriers. Excluded are passenger services provided
      to nonresidents by resident carriers within the resident
      economies; these are included in travel items. In addition to the
      services covered by passenger fares--including fares that are a
      part of package tours but excluding cruise fares, which are
      included in travel--passenger services include such items as
      charges for excess baggage, vehicles, or other personal
      accompanying effects and expenditures for food, drink, or other
      items for which passengers make expenditures while on board
      carriers. Data are in current U.S. dollars.

-  ST.INT.TVLR.CD

   -  International tourism, receipts for travel items (current US$)
   -  International tourism receipts for travel items are expenditures
      by international inbound visitors in the reporting economy. The
      goods and services are purchased by, or on behalf of, the traveler
      or provided, without a quid pro quo, for the traveler to use or
      give away. These receipts should include any other prepayment made
      for goods or services received in the destination country. They
      also may include receipts from same-day visitors, except in cases
      where these are so important as to justify a separate
      classification. Excluded is the international carriage of
      travelers, which is covered in passenger travel items. Data are in
      current U.S. dollars.

-  Outbound tourism
-  ST.INT.XPND.MP.ZS

   -  International tourism, expenditures (% of total imports)
   -  International tourism expenditures are expenditures of
      international outbound visitors in other countries, including
      payments to foreign carriers for international transport. These
      expenditures may include those by residents traveling abroad as
      same-day visitors, except in cases where these are important
      enough to justify separate classification. For some countries they
      do not include expenditures for passenger transport items. Their
      share in imports is calculated as a ratio to imports of goods and
      services, which comprise all transactions between residents of a
      country and the rest of the world involving a change of ownership
      from nonresidents to residents of general merchandise, goods sent
      for processing and repairs, nonmonetary gold, and services.

-  ST.INT.XPND.CD

   -  International tourism, expenditures (current US$)
   -  International tourism expenditures are expenditures of
      international outbound visitors in other countries, including
      payments to foreign carriers for international transport. These
      expenditures may include those by residents traveling abroad as
      same-day visitors, except in cases where these are important
      enough to justify separate classification. For some countries they
      do not include expenditures for passenger transport items. Data
      are in current U.S. dollars.

-  ST.INT.TRNX.CD

   -  International tourism, expenditures for passenger transport items
      (current US$)
   -  International tourism expenditures for passenger transport items
      are expenditures of international outbound visitors in other
      countries for all services provided during international
      transportation by nonresident carriers. Also included are
      passenger services performed within an economy by nonresident
      carriers. Excluded are passenger services provided to nonresidents
      by resident carriers within the resident economies; these are
      included in travel items. In addition to the services covered by
      passenger fares--including fares that are a part of package tours
      but excluding cruise fares, which are included in
      travel--passenger services include such items as charges for
      excess baggage, vehicles, or other personal accompanying effects
      and expenditures for food, drink, or other items for which
      passengers make expenditures while on board carriers. Data are in
      current U.S. dollars.

-  ST.INT.TVLX.CD

   -  International tourism, expenditures for travel items (current US$)
   -  International tourism expenditures are expenditures of
      international outbound visitors in other countries. The goods and
      services are purchased by, or on behalf of, the traveler or
      provided, without a quid pro quo, for the traveler to use or give
      away. These may include expenditures by residents traveling abroad
      as same-day visitors, except in cases where these are so important
      as to justify a separate classification. Excluded is the
      international carriage of travelers, which is covered in passenger
      travel items. Data are in current U.S. dollars.

-  ST.INT.DPRT

   -  International tourism, number of departures
   -  International outbound tourists are the number of departures that
      people make from their country of usual residence to any other
      country for any purpose other than a remunerated activity in the
      country visited. The data on outbound tourists refer to the number
      of departures, not to the number of people traveling. Thus a
      person who makes several trips from a country during a given
      period is counted each time as a new departure.

Data Comparison
---------------

Variable Comparison
~~~~~~~~~~~~~~~~~~~

+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| UWTO Variable                                               | WDI Variable        | WDI Name                                                                          |
+=============================================================+=====================+===================================================================================+
| Inbound: Arrivals - Thousands                               | ST.INT.ARVL         | International tourism, number of arrivals                                         |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Inbound: Tourism expenditure in the country - US$ Mn        | ST.INT.RCPT.CD      | International tourism, receipts (current US$)                                     |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Inbound: Travel - US$ Mn                                    | ST.INT.TVLR.CD      | International tourism, receipts for passenger transport items (current US$)       |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Inbound: Passenger transport - US$ Mn                       | ST.INT.TRNR.CD      | International tourism, receipts for travel items (current US$)                    |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Outbound: Departures - Thousands                            | ST.INT.DPRT         | International tourism, expenditures (current US$)                                 |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Outbound: Tourism expenditure in other countries - US$ Mn   | ST.INT.XPND.CD      | International tourism, expenditures for passenger transport items (current US$)   |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Outbound: Travel - US$ Mn                                   | ST.INT.TVLX.CD      | International tourism, expenditures for travel items (current US$)                |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| Outbound: Passenger transport - US$ Mn                      | ST.INT.TRNX.CD      | International tourism, number of departures                                       |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| None                                                        | ST.INT.RCPT.XP.ZS   | International tourism, receipts (% of total exports)                              |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+
| None                                                        | ST.INT.XPND.MP.ZS   | International tourism, expenditures (% of total imports)                          |
+-------------------------------------------------------------+---------------------+-----------------------------------------------------------------------------------+

All of the data from the UWTO dataset appears to be included in the WDI
data. The WDI dataset has two additional indicators that are computed as
a percentage of total imports and exports.

$ \* 100 $

.. code:: ipython3

    import missingno as msno
    import pandas as pd
    
    %matplotlib inline
    
    pd.set_option('display.float_format', lambda x: '%.3f' % x)

.. code:: ipython3

    # Read dataframes from processing notebook
    uwto = pd.read_pickle("../data/interim/UWTO.pickle")
    wdi = pd.read_pickle("../data/interim/WDI.pickle")

.. code:: ipython3

    # create lists of Years and Countries for both datasets
    uwto_years = uwto['Year'].unique().tolist()
    wdi_years = wdi['Year'].unique().tolist()
    uwto_countries = uwto['Country Code'].unique().tolist()
    wdi_countries = wdi['Country Code'].unique().tolist()

Data Time Span
~~~~~~~~~~~~~~

UWTO has data from {{ min(uwto\_years) }} to {{ max(uwto\_years) }}, WDI
has {{ min(wdi\_years) }} to {{ max(wdi\_years) }}.

Countries Included
~~~~~~~~~~~~~~~~~~

UWTO has {{ len(uwto\_countries) }} countries with data, WDI has {{
len(wdi\_countries) }} countries with data.

.. code:: ipython3

    # create lists of countries unique to each dataset
    uwto_unique = str([x for x in uwto_countries if x not in wdi_countries])
    wdi_unique = str([x for x in wdi_countries if x not in uwto_countries])

Only UWTO has data for {{uwto\_unique}}, and only WDI has data for
{{wdi\_unique}}

Variable Characteristics
~~~~~~~~~~~~~~~~~~~~~~~~

    UWTO data has to be transformed to standard single units and
    identically labeled for comparison

.. code:: ipython3

    uwto_units = pd.DataFrame({
        'Country Code':
        uwto['Country Code'],
        'Year':
        uwto['Year'],
        'ST.INT.ARVL':
        uwto['Inbound: Arrivals - Thousands'].apply(lambda x: x * 1000),
        'ST.INT.XPND.CD':
        uwto['Outbound: Tourism expenditure in other countries - US$ Mn'].apply(
            lambda x: x * 1000000),
        'ST.INT.TRNX.CD':
        uwto['Outbound: Passenger transport - US$ Mn'].apply(lambda x: x * 1000000
                                                             ),
        'ST.INT.TVLX.CD':
        uwto['Outbound: Travel - US$ Mn'].apply(lambda x: x * 1000000),
        'ST.INT.DPRT':
        uwto['Outbound: Departures - Thousands'].apply(lambda x: x * 1000),
        'ST.INT.RCPT.CD':
        uwto['Inbound: Tourism expenditure in the country - US$ Mn'].apply(
            lambda x: x * 1000000),
        'ST.INT.TRNR.CD':
        uwto['Inbound: Passenger transport - US$ Mn'].apply(lambda x: x * 1000000),
        'ST.INT.TVLR.CD':
        uwto['Inbound: Travel - US$ Mn'].apply(lambda x: x * 1000000),
    })

.. code:: ipython3

    wdi[(wdi['Year'] > 1994)].describe()




.. raw:: html

    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }
    
        .dataframe tbody tr th {
            vertical-align: top;
        }
    
        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>ST.INT.ARVL</th>
          <th>ST.INT.XPND.MP.ZS</th>
          <th>ST.INT.XPND.CD</th>
          <th>ST.INT.TRNX.CD</th>
          <th>ST.INT.TVLX.CD</th>
          <th>ST.INT.DPRT</th>
          <th>ST.INT.RCPT.XP.ZS</th>
          <th>ST.INT.RCPT.CD</th>
          <th>ST.INT.TRNR.CD</th>
          <th>ST.INT.TVLR.CD</th>
          <th>Year</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>count</th>
          <td>4390.000</td>
          <td>3748.000</td>
          <td>4055.000</td>
          <td>3289.000</td>
          <td>3956.000</td>
          <td>2234.000</td>
          <td>3752.000</td>
          <td>4266.000</td>
          <td>3033.000</td>
          <td>3985.000</td>
          <td>5160.000</td>
        </tr>
        <tr>
          <th>mean</th>
          <td>4417208.200</td>
          <td>6.605</td>
          <td>4828076388.212</td>
          <td>794672287.039</td>
          <td>4228815999.141</td>
          <td>8031308.268</td>
          <td>16.952</td>
          <td>4928297940.752</td>
          <td>922708154.258</td>
          <td>4476780046.173</td>
          <td>2006.500</td>
        </tr>
        <tr>
          <th>std</th>
          <td>10272868.297</td>
          <td>4.332</td>
          <td>15399011971.733</td>
          <td>2718791242.890</td>
          <td>13733953517.299</td>
          <td>16159876.350</td>
          <td>18.848</td>
          <td>14801029019.088</td>
          <td>2995992210.148</td>
          <td>12946159292.781</td>
          <td>6.923</td>
        </tr>
        <tr>
          <th>min</th>
          <td>700.000</td>
          <td>0.183</td>
          <td>100000.000</td>
          <td>100000.000</td>
          <td>10000.000</td>
          <td>1900.000</td>
          <td>0.001</td>
          <td>100000.000</td>
          <td>11000.000</td>
          <td>100000.000</td>
          <td>1995.000</td>
        </tr>
        <tr>
          <th>25%</th>
          <td>199000.000</td>
          <td>3.696</td>
          <td>97000000.000</td>
          <td>21000000.000</td>
          <td>71000000.000</td>
          <td>486250.000</td>
          <td>4.269</td>
          <td>119250000.000</td>
          <td>17000000.000</td>
          <td>107000000.000</td>
          <td>2000.750</td>
        </tr>
        <tr>
          <th>50%</th>
          <td>800000.000</td>
          <td>5.579</td>
          <td>423000000.000</td>
          <td>87000000.000</td>
          <td>329367300.000</td>
          <td>1957000.000</td>
          <td>9.356</td>
          <td>660000000.000</td>
          <td>128000000.000</td>
          <td>578000000.000</td>
          <td>2006.500</td>
        </tr>
        <tr>
          <th>75%</th>
          <td>3513500.000</td>
          <td>8.303</td>
          <td>2628500000.000</td>
          <td>375000000.000</td>
          <td>2240000000.000</td>
          <td>7331250.000</td>
          <td>22.104</td>
          <td>3372000000.000</td>
          <td>593000000.000</td>
          <td>3204000000.000</td>
          <td>2012.250</td>
        </tr>
        <tr>
          <th>max</th>
          <td>86861000.000</td>
          <td>42.441</td>
          <td>257733000000.000</td>
          <td>38896000000.000</td>
          <td>257733000000.000</td>
          <td>143035000.000</td>
          <td>170.479</td>
          <td>251361000000.000</td>
          <td>44071000000.000</td>
          <td>210748000000.000</td>
          <td>2018.000</td>
        </tr>
      </tbody>
    </table>
    </div>



.. code:: ipython3

    uwto_units.describe()




.. raw:: html

    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }
    
        .dataframe tbody tr th {
            vertical-align: top;
        }
    
        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Year</th>
          <th>ST.INT.ARVL</th>
          <th>ST.INT.XPND.CD</th>
          <th>ST.INT.TRNX.CD</th>
          <th>ST.INT.TVLX.CD</th>
          <th>ST.INT.DPRT</th>
          <th>ST.INT.RCPT.CD</th>
          <th>ST.INT.TRNR.CD</th>
          <th>ST.INT.TVLR.CD</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>count</th>
          <td>4784.000</td>
          <td>4443.000</td>
          <td>3362.000</td>
          <td>3258.000</td>
          <td>3918.000</td>
          <td>2232.000</td>
          <td>3293.000</td>
          <td>2960.000</td>
          <td>3912.000</td>
        </tr>
        <tr>
          <th>mean</th>
          <td>2006.000</td>
          <td>4353298.382</td>
          <td>4721673395.234</td>
          <td>840985896.905</td>
          <td>4413844638.249</td>
          <td>8088750.793</td>
          <td>5044589334.038</td>
          <td>913754118.992</td>
          <td>4369168477.702</td>
        </tr>
        <tr>
          <th>std</th>
          <td>6.634</td>
          <td>10188841.756</td>
          <td>13993577827.374</td>
          <td>2748006432.447</td>
          <td>13907250089.380</td>
          <td>16163715.919</td>
          <td>15781899104.096</td>
          <td>3013909725.017</td>
          <td>12919374220.871</td>
        </tr>
        <tr>
          <th>min</th>
          <td>1995.000</td>
          <td>700.000</td>
          <td>100000.000</td>
          <td>100000.000</td>
          <td>10000.000</td>
          <td>500.000</td>
          <td>400000.000</td>
          <td>11000.000</td>
          <td>100000.000</td>
        </tr>
        <tr>
          <th>25%</th>
          <td>2000.000</td>
          <td>187000.000</td>
          <td>114250000.000</td>
          <td>22000000.000</td>
          <td>67000000.000</td>
          <td>451500.000</td>
          <td>177000000.000</td>
          <td>17000000.000</td>
          <td>106000000.000</td>
        </tr>
        <tr>
          <th>50%</th>
          <td>2006.000</td>
          <td>769000.000</td>
          <td>442000000.000</td>
          <td>96000000.000</td>
          <td>326000000.000</td>
          <td>2022000.000</td>
          <td>746000000.000</td>
          <td>128000000.000</td>
          <td>574500000.000</td>
        </tr>
        <tr>
          <th>75%</th>
          <td>2012.000</td>
          <td>3470000.000</td>
          <td>2700750000.000</td>
          <td>423000000.000</td>
          <td>2410750000.000</td>
          <td>7773750.000</td>
          <td>3441000000.000</td>
          <td>593000000.000</td>
          <td>3056500000.000</td>
        </tr>
        <tr>
          <th>max</th>
          <td>2017.000</td>
          <td>86861000.000</td>
          <td>173919000000.000</td>
          <td>38896000000.000</td>
          <td>257733000000.000</td>
          <td>143035000.000</td>
          <td>251361000000.000</td>
          <td>44071000000.000</td>
          <td>210748000000.000</td>
        </tr>
      </tbody>
    </table>
    </div>



Missing Data
~~~~~~~~~~~~

.. code:: ipython3

    # Visualize missing data for easier comparison
    msno.matrix(wdi[(wdi['Year'] > 1994)])
    msno.matrix(uwto_units)




.. parsed-literal::

    <matplotlib.axes._subplots.AxesSubplot at 0x2aca52bb0a58>




.. image:: ../docs/notebooks/1_files/../docs/notebooks/1_15_1.png



.. image:: ../docs/notebooks/1_files/../docs/notebooks/1_15_2.png


Data Combining
--------------

The data from WDI includes more years, but the data direct from UWTO has
fewer missing values than the same time frame in the WDI data. I will
take the WDI data and fill mising values with UWTO data when possible.

.. code:: ipython3

    # Set DF indexes for join
    wdi_indexed = wdi.set_index(["Country Code", "Year"])
    uwto_indexed = uwto_units.set_index(["Country Code", "Year"])

.. code:: ipython3

    # left join no overwriting
    wdi_indexed.update(uwto_indexed, overwrite=False)

.. code:: ipython3

    # reset DF index
    wdi_indexed.reset_index(inplace=True)

.. code:: ipython3

    # visualize missing values for before and after comparison
    msno.matrix(wdi[(wdi['Year'] > 1994)])
    msno.matrix(wdi_indexed[(wdi_indexed['Year'] > 1994)])




.. parsed-literal::

    <matplotlib.axes._subplots.AxesSubplot at 0x2aca532d0860>




.. image:: ../docs/notebooks/1_files/../docs/notebooks/1_20_1.png



.. image:: ../docs/notebooks/1_files/../docs/notebooks/1_20_2.png


Saving Final Data
-----------------

There are visibly fewer missing values in the data after the merge
function. The data can now be saved for analysis and combination with
other datasets.

.. code:: ipython3

    wdi_indexed.to_pickle("../data/interim/Tourism.pickle")
